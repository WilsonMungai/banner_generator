<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cruise Countdown Banner</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 2rem;
    }
    canvas {
      border: 2px solid white;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h1>Cruise Countdown Banner</h1>
  <canvas id="bannerCanvas" width="1200" height="800"></canvas>

  <script>
    const canvas = document.getElementById("bannerCanvas");
    const ctx = canvas.getContext("2d");

    async function drawBanner({
      cruiseName,
      destination,
      sailDate,
      days,
      hours,
      mins,
      imageUrl,
      logoUrl,
      eventName
    }) {
      const userImage = new Image();
      userImage.crossOrigin = "anonymous";
      userImage.src = imageUrl;

      return new Promise((resolve) => {
        userImage.onload = () => {
          ctx.clearRect(0, 0, canvas.width, canvas.height);

          // Background color
          ctx.fillStyle = "#FF2DAE";
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          // Draw User Image (430x262, centered)
          const imgWidth = 430;
          const imgHeight = 262;
          const imgX = (canvas.width - imgWidth) / 2;
          const imgY = 20;
          ctx.drawImage(userImage, imgX, imgY, imgWidth, imgHeight);

          // Blue container under image
          const containerY = imgY + imgHeight + 20;
          const containerHeight = 100;
          ctx.fillStyle = "#00FFFF";
          ctx.fillRect(0, containerY, canvas.width, containerHeight);

          // Border lines
          ctx.strokeStyle = "black";
          ctx.lineWidth = 0.5;
          ctx.beginPath();
          ctx.moveTo(0, containerY);
          ctx.lineTo(canvas.width, containerY);
          ctx.moveTo(0, containerY + containerHeight);
          ctx.lineTo(canvas.width, containerY + containerHeight);
          ctx.stroke();

          // Blue container text
          ctx.fillStyle = "#000";
          ctx.font = "bold 16px sans-serif";
          ctx.textAlign = "center";

          const centerX = canvas.width / 2;
          const textYStart = containerY + 30;
          const spacing = 25;

          ctx.fillText(cruiseName.toUpperCase(), centerX, textYStart);
          ctx.fillText(("Destination: " + destination).toUpperCase(), centerX, textYStart + spacing);
          ctx.fillText(("Sailing on: " + sailDate).toUpperCase(), centerX, textYStart + spacing * 2);

          // Event name (bold, uppercase, 20px)
          const eventY = containerY + containerHeight + 40;
          ctx.fillStyle = "#fff";
          ctx.font = "bold 20px sans-serif";
          ctx.fillText(eventName.toUpperCase(), centerX, eventY);

          // Load and draw logo
          const logoImage = new Image();
          logoImage.crossOrigin = "anonymous";
          logoImage.src = logoUrl;

          logoImage.onload = () => {
            const logoWidth = 400;
            const logoHeight = 100;
            const logoX = (canvas.width - logoWidth) / 2;
            const logoY = eventY + 20;
            ctx.drawImage(logoImage, logoX, logoY, logoWidth, logoHeight);

            // Countdown text below logo
            const countdownY = logoY + logoHeight + 60;
            ctx.fillStyle = "#fff";
            ctx.font = "bold 100px monospace";
            ctx.textAlign = "left";
            ctx.fillText(`${days}d ${hours}h ${mins}m`, 50, countdownY);

            resolve();
          };

          logoImage.onerror = () => {
            // Fallback if logo fails
            const fallbackY = eventY + 100;
            ctx.fillStyle = "#fff";
            ctx.font = "bold 100px monospace";
            ctx.textAlign = "left";
            ctx.fillText(`${days}d ${hours}h ${mins}m`, 50, fallbackY);
            resolve();
          };
        };

        userImage.onerror = () => {
          // Fallback if user image fails
          ctx.fillStyle = "#FF2DAE";
          ctx.fillRect(0, 0, canvas.width, canvas.height);

          ctx.fillStyle = "#fff";
          ctx.font = "bold 60px sans-serif";
          ctx.fillText(cruiseName, 50, 100);
          ctx.font = "40px sans-serif";
          ctx.fillText("Destination: " + destination, 50, 180);
          ctx.fillText("Sailing on: " + sailDate, 50, 250);
          ctx.font = "bold 100px monospace";
          ctx.fillText(`${days}d ${hours}h ${mins}m`, 50, 400);

          resolve();
        };
      });
    }
  </script>
</body>
</html>